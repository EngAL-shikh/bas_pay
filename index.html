<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دليل ربط بوابة الدفع BAS - Flutter + Laravel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link rel="stylesheet" href="assets/style.css">
</head>
<body class="antialiased">
    <div class="container mx-auto max-w-6xl px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-5xl font-bold text-white mb-4">دليل ربط بوابة الدفع BAS</h1>
            <p class="text-xl text-white/90 max-w-3xl mx-auto">
                دليل شامل وتفاعلي لربط بوابة الدفع BAS مع تطبيقات Flutter و Laravel
            </p>
            <div class="mt-6">
                <div class="progress-bar max-w-md mx-auto">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p class="text-white/80 mt-2" id="progressText">ابدأ بالخطوة الأولى</p>
            </div>
        </header>

        <!-- Steps Container -->
        <div id="stepsContainer">
            <!-- Step 1: Prerequisites -->
            <div class="step-card rounded-xl p-8 mb-8 fade-in" id="step1">
                <div class="flex items-center mb-6">
                    <div class="step-number step-active" id="step1Number">1</div>
                    <div class="mr-4">
                        <h2 class="text-2xl font-bold text-gray-800">المتطلبات الأساسية</h2>
                        <p class="text-gray-600">إعداد البيئة والأدوات المطلوبة</p>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-800">📋 قائمة التحقق</h3>
                        <div class="space-y-3">
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-3" id="check1">
                                <span>حساب تاجر مع BAS (Client ID & Secret)</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-3" id="check2">
                                <span>مشروع Laravel جاهز</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-3" id="check3">
                                <span>مشروع Flutter جاهز</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-3" id="check4">
                                <span>Composer مثبت</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="space-y-4">
                        <h3 class="text-lg font-semibold text-gray-800">🔑 بيانات BAS</h3>
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4">
                            <div class="flex items-start">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="mr-3">
                                    <h4 class="text-sm font-medium text-yellow-800">⚠️ مهم جداً</h4>
                                    <p class="text-sm text-yellow-700 mt-1">
                                        هذه البيانات الحساسة يجب أن تكون <strong>في الباك اند فقط</strong> وليس في Flutter. 
                                        Flutter يحصل فقط على <code>trxToken</code> من الباك اند.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">App ID</label>
                                <input type="text" class="w-full p-2 border rounded" id="appId" 
                                       value="YOUR_APP_ID" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Merchant Key</label>
                                <input type="text" class="w-full p-2 border rounded" id="merchantKey" 
                                       value="YOUR_MERCHANT_KEY" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Client ID</label>
                                <input type="text" class="w-full p-2 border rounded" id="clientId" 
                                       value="YOUR_CLIENT_ID" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Client Secret</label>
                                <input type="text" class="w-full p-2 border rounded" id="clientSecret" 
                                       value="YOUR_CLIENT_SECRET" readonly>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <button onclick="completeStep(1)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        ✅ أكمل الخطوة الأولى
                    </button>
                </div>
            </div>

            <!-- Step 2: Laravel Backend Setup -->
            <div class="step-card rounded-xl p-8 mb-8 hidden" id="step2">
                <div class="flex items-center mb-6">
                    <div class="step-number" id="step2Number">2</div>
                    <div class="mr-4">
                        <h2 class="text-2xl font-bold text-gray-800">إعداد Laravel Backend</h2>
                        <p class="text-gray-600">تثبيت SDK وإنشاء Controllers</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <!-- Install SDK -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">📦 تثبيت BAS Laravel SDK</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('installSdk')">نسخ</button>
                            <pre><code id="installSdk">composer require basgate/laravel-sdk</code></pre>
                        </div>
                    </div>

                    <!-- Config File -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">⚙️ إنشاء ملف التكوين</h3>
                        <p class="text-gray-600 mb-3">أنشئ ملف <code>config/bas.php</code>:</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('configFile')">نسخ</button>
                            <pre><code id="configFile">&lt;?php

return [
    'base_url' => env('BAS_BASE_URL', 'https://api-tst.basgate.com'),
    'client_id' => env('BAS_CLIENT_ID', 'your_client_id'),
    'client_secret' => env('BAS_CLIENT_SECRET', 'your_client_secret'),
    'app_id' => env('BAS_APP_ID', 'your_app_id'),
    'merchant_key' => env('BAS_MERCHANT_KEY', 'your_merchant_key'),
    'iv' => env('BAS_IV', '@@@@&&&&####$$$$'),
    'callback_uri' => env('BAS_CALLBACK_URI', 'http://localhost:8000/callback'),
    
    'token_endpoint' => env('BAS_TOKEN_ENDPOINT', '/api/v1/auth/token'),
    'user_info_endpoint' => env('BAS_USER_INFO_ENDPOINT', '/api/v1/auth/secure/userinfo'),
    'refund_payment_endpoint' => env('BAS_REFUND_PAYMENT_ENDPOINT', '/api/v1/merchant/refund-payment/request'),
    'transaction_status_endpoint' => env('BAS_TRANSACTION_STATUS_ENDPOINT', '/api/v1/merchant/secure/transaction/status'),
    'transaction_initiate_endpoint' => env('BAS_TRANSACTION_INITIATE_ENDPOINT', '/api/v1/merchant/secure/transaction/initiate'),
    'notifications_endpoint' => env('BAS_NOTIFICATIONS_ENDPOINT', '/api/v1/merchant/secure/notifications/send-to-customer'),
    
    'verify_ssl' => env('BAS_VERIFY_SSL', false),
    'timeout' => env('BAS_TIMEOUT', 30),
];</code></pre>
                        </div>
                    </div>

                    <!-- Service Provider -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">🔧 تسجيل Service Provider</h3>
                        <p class="text-gray-600 mb-3">أضف في <code>bootstrap/providers.php</code>:</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('serviceProvider')">نسخ</button>
                            <pre><code id="serviceProvider">&lt;?php

return [
    App\Providers\AppServiceProvider::class,
    Bas\LaravelSdk\BasServiceProvider::class, // أضف هذا السطر
];</code></pre>
                        </div>
                    </div>

                    <!-- API Tester -->
                    <div class="api-tester">
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">🧪 اختبار API</h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Base URL</label>
                                <input type="text" class="w-full p-2 border rounded" id="apiBaseUrl" 
                                       value="http://localhost:8000">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Auth Token</label>
                                <input type="text" class="w-full p-2 border rounded" id="authToken" 
                                       placeholder="Bearer token...">
                            </div>
                        </div>
                        <button onclick="testInitiateAPI()" class="mt-3 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                            🚀 اختبار Initiate Payment
                        </button>
                        <div class="response-area mt-3" id="apiResponse">النتيجة ستظهر هنا...</div>
                    </div>

                    <!-- Examples Notice -->
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4 mt-6">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div class="mr-3">
                                <h3 class="text-sm font-medium text-green-800">📁 ملفات Laravel الجاهزة</h3>
                                <div class="mt-2 text-sm text-green-700">
                                    <p>يوجد في مجلد <code>examples/</code> ملفات Laravel جاهزة:</p>
                                    <ul class="list-disc list-inside mt-2 space-y-1">
                                        <li><code>laravel_controller.php</code> - Controller كامل مع logging</li>
                                        <li><code>migration.php</code> - جدول قاعدة البيانات</li>
                                        <li><code>payment_model.php</code> - Model متقدم</li>
                                        <li><code>laravel_routes.php</code> - Routes كاملة</li>
                                    </ul>
                                    <p class="mt-2 font-medium">انسخ هذه الملفات واستخدمها مباشرة!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center space-x-4">
                    <button onclick="goToPreviousStep()" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors">
                        ← الخطوة السابقة
                    </button>
                    <button onclick="completeStep(2)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        ✅ أكمل الخطوة الثانية
                    </button>
                </div>
            </div>

            <!-- Step 3: Flutter Frontend Setup -->
            <div class="step-card rounded-xl p-8 mb-8 hidden" id="step3">
                <div class="flex items-center mb-6">
                    <div class="step-number" id="step3Number">3</div>
                    <div class="mr-4">
                        <h2 class="text-2xl font-bold text-gray-800">إعداد Flutter Frontend</h2>
                        <p class="text-gray-600">تثبيت SDK وإنشاء Payment Service</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <!-- Add Dependency -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">📦 إضافة Dependency</h3>
                        <p class="text-gray-600 mb-3">أضف في <code>pubspec.yaml</code>:</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('flutterDependency')">نسخ</button>
                            <pre><code id="flutterDependency">dependencies:
  bas_pay_flutter:
    git:
      url: https://github.com/Osamah-Attiah/bas_pay_flutter.git
  get: ^4.6.6
  get_storage: ^2.1.1
  http: ^1.1.0</code></pre>
                        </div>
                    </div>

                    <!-- Payment Service -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">🔧 إنشاء Payment Service</h3>
                        <div class="bg-green-50 border border-green-200 rounded-lg p-3 mb-4">
                            <div class="flex items-start">
                                <div class="flex-shrink-0">
                                    <svg class="h-5 w-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <div class="mr-3">
                                    <h4 class="text-sm font-medium text-green-800">✅ الأمان</h4>
                                    <p class="text-sm text-green-700 mt-1">
                                        لاحظ أن Flutter <strong>لا يحتوي على بيانات BAS الحساسة</strong>. 
                                        يحصل فقط على <code>trxToken</code> من الباك اند.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <p class="text-gray-600 mb-3">أنشئ ملف <code>lib/app/core/services/bas_payment_service.dart</code>:</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('paymentService')">نسخ</button>
                            <pre><code id="paymentService">import 'dart:convert';
import 'package:http/http.dart' as http;
import 'package:get/get.dart';
import 'package:get_storage/get_storage.dart';
import 'package:bas_pay_flutter/bas_pay_flutter.dart';
import 'package:bas_pay_flutter/models/init_bas_sdk_model.dart';

class BasPaymentService extends GetxService {
  String? _currentTrxToken;
  String? _currentTrxId;
  String? _currentOrderId;

  /// إنشاء طلب دفع جديد
  Future&lt;Map&lt;String, dynamic&gt;&gt; initiatePayment({
    required double amount,
    required String orderId,
    required String customerId,
    required String customerName,
    required String customerPhone,
  }) async {
    try {
      final response = await http.post(
        Uri.parse('${_getBackendUrl()}/api/payment/initiate'),
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
          'Authorization': 'Bearer ${_getAuthToken()}',
        },
        body: jsonEncode({
          'amount': amount,
          'order_id': orderId,
          'customer_id': customerId,
          'customer_name': customerName,
          'customer_phone': customerPhone,
        }),
      );

      if (response.statusCode == 200) {
        final data = jsonDecode(response.body);
        if (data['success'] == true) {
          _currentTrxToken = data['data']['trx_token'];
          _currentTrxId = data['data']['trx_id'];
          _currentOrderId = orderId;
          
          return {
            'success': true,
            'trx_token': _currentTrxToken,
            'trx_id': _currentTrxId,
            'order_id': orderId,
          };
        }
      }
      return {'success': false, 'error': 'فشل في إنشاء طلب الدفع'};
    } catch (e) {
      return {'success': false, 'error': e.toString()};
    }
  }

  /// استدعاء واجهة الدفع BAS
  Future&lt;Map&lt;String, dynamic&gt;&gt; callBasPaymentSdk({
    required String trxToken,
    required String userPhone,
    required String fullName,
  }) async {
    try {
      final model = InitBasSdkModel.dev(
        trxToken: trxToken,
        userIdentifier: userPhone,
        fullName: fullName,
        language: 'ar',
      );

      final result = await BasPayFlutter().callBasPay(model: model);

      if (result.resultStatus && result.resultModel?.status == true) {
        return {
          'success': true,
          'trx_id': trxToken,
          'message': 'تم الدفع بنجاح',
          'is_simulation': false,
          'bas_result': result.resultModel?.toJson(),
        };
      } else {
        return {
          'success': false,
          'error': result.resultModel?.message ?? 'خطأ غير معروف',
        };
      }
    } catch (e) {
      return {'success': false, 'error': e.toString()};
    }
  }

  String _getBackendUrl() {
    return 'http://YOUR_BACKEND_URL:8000'; // غيّر هذا
  }

  String _getAuthToken() {
    try {
      return Get.find&lt;GetStorage&gt;().read('auth_token') ?? '';
    } catch (e) {
      return '';
    }
  }
}</code></pre>
                        </div>
                    </div>

                    <!-- Register Service -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">📝 تسجيل Service</h3>
                        <p class="text-gray-600 mb-3">أضف في <code>lib/main.dart</code>:</p>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('registerService')">نسخ</button>
                            <pre><code id="registerService">import 'package:mqut_app/app/core/services/bas_payment_service.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return GetMaterialApp(
      title: 'Flutter Demo',
      home: MyHomePage(),
      initialBinding: InitialBinding(),
    );
  }
}

class InitialBinding extends Bindings {
  @override
  void dependencies() {
    Get.put(GetStorage());
    Get.put(BasPaymentService());
  }
}</code></pre>
                        </div>
                    </div>

                    <!-- Examples Notice -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-6">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div class="mr-3">
                                <h3 class="text-sm font-medium text-blue-800">💡 ملفات الأمثلة الجاهزة</h3>
                                <div class="mt-2 text-sm text-blue-700">
                                    <p>يوجد في مجلد <code>examples/</code> ملفات جاهزة للاستخدام:</p>
                                    <ul class="list-disc list-inside mt-2 space-y-1">
                                        <li><code>flutter_service.dart</code> - خدمة الدفع الكاملة</li>
                                        <li><code>usage_example.dart</code> - مثال شامل على الاستخدام</li>
                                        <li><code>laravel_controller.php</code> - Controller للباك اند</li>
                                        <li><code>migration.php</code> - جدول قاعدة البيانات</li>
                                        <li><code>payment_model.php</code> - Model المعاملات</li>
                                    </ul>
                                    <p class="mt-2 font-medium">يمكنك نسخ هذه الملفات واستخدامها مباشرة في مشروعك!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center space-x-4">
                    <button onclick="goToPreviousStep()" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors">
                        ← الخطوة السابقة
                    </button>
                    <button onclick="completeStep(3)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        ✅ أكمل الخطوة الثالثة
                    </button>
                </div>
            </div>

            <!-- Step 4: Integration & Testing -->
            <div class="step-card rounded-xl p-8 mb-8 hidden" id="step4">
                <div class="flex items-center mb-6">
                    <div class="step-number" id="step4Number">4</div>
                    <div class="mr-4">
                        <h2 class="text-2xl font-bold text-gray-800">التكامل والاختبار</h2>
                        <p class="text-gray-600">ربط Frontend مع Backend واختبار العملية</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <!-- Payment Flow -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">🔄 تدفق عملية الدفع</h3>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <ol class="list-decimal list-inside space-y-2 text-gray-700">
                                <li>المستخدم يضغط على زر "الدفع" في Flutter</li>
                                <li>Flutter يرسل طلب لـ Laravel Backend</li>
                                <li>Laravel ينشئ معاملة مع BAS ويحصل على trxToken</li>
                                <li>Laravel يرسل trxToken لـ Flutter</li>
                                <li>Flutter يستدعي BAS SDK مع trxToken</li>
                                <li>BAS SDK يعرض واجهة الدفع للمستخدم</li>
                                <li>المستخدم يكمل عملية الدفع</li>
                                <li>BAS SDK يرسل النتيجة لـ Flutter</li>
                                <li>Flutter يرسل النتيجة لـ Laravel للتأكيد</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Example Usage -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">💡 مثال على الاستخدام</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('exampleUsage')">نسخ</button>
                            <pre><code id="exampleUsage">// في Flutter Controller
class PaymentController extends GetxController {
  final BasPaymentService _paymentService = Get.find();

  Future&lt;void&gt; processPayment() async {
    try {
      // الخطوة 1: إنشاء طلب الدفع
      final initiateResult = await _paymentService.initiatePayment(
        amount: 50000.0,
        orderId: 'order_${DateTime.now().millisecondsSinceEpoch}',
        customerId: 'user_123',
        customerName: 'أحمد محمد',
        customerPhone: '777777777',
      );

      if (initiateResult['success']) {
        // الخطوة 2: استدعاء واجهة الدفع
        final paymentResult = await _paymentService.callBasPaymentSdk(
          trxToken: initiateResult['trx_token'],
          userPhone: '777777777',
          fullName: 'أحمد محمد',
        );

        if (paymentResult['success']) {
          Get.snackbar('نجح', 'تم الدفع بنجاح!');
        } else {
          Get.snackbar('فشل', paymentResult['error']);
        }
      }
    } catch (e) {
      Get.snackbar('خطأ', e.toString());
    }
  }
}</code></pre>
                        </div>
                    </div>

                    <!-- Testing Checklist -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">✅ قائمة اختبار شاملة</h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Backend Tests</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">إنشاء معاملة جديدة</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">التحقق من حالة المعاملة</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">تأكيد الدفع</span>
                                    </label>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Frontend Tests</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">عرض واجهة الدفع</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">معالجة النجاح</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">معالجة الفشل</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Examples Notice -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div class="mr-3">
                                <h3 class="text-sm font-medium text-yellow-800">🔧 ملفات التكامل الجاهزة</h3>
                                <div class="mt-2 text-sm text-yellow-700">
                                    <p>يوجد في مجلد <code>examples/</code> ملفات التكامل الكاملة:</p>
                                    <ul class="list-disc list-inside mt-2 space-y-1">
                                        <li><code>usage_example.dart</code> - مثال شامل على الاستخدام</li>
                                        <li><code>flutter_service.dart</code> - خدمة الدفع الكاملة</li>
                                        <li><code>laravel_controller.php</code> - Controller للباك اند</li>
                                    </ul>
                                    <p class="mt-2 font-medium">هذه الملفات تحتوي على كود جاهز للاستخدام مع معالجة الأخطاء!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center space-x-4">
                    <button onclick="goToPreviousStep()" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors">
                        ← الخطوة السابقة
                    </button>
                    <button onclick="completeStep(4)" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        ✅ أكمل الخطوة الرابعة
                    </button>
                </div>
            </div>

            <!-- Step 5: Deployment & Production -->
            <div class="step-card rounded-xl p-8 mb-8 hidden" id="step5">
                <div class="flex items-center mb-6">
                    <div class="step-number" id="step5Number">5</div>
                    <div class="mr-4">
                        <h2 class="text-2xl font-bold text-gray-800">النشر والإنتاج</h2>
                        <p class="text-gray-600">إعداد البيئة الإنتاجية والأمان</p>
                    </div>
                </div>

                <div class="space-y-6">
                    <!-- Environment Variables -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">🔐 متغيرات البيئة الإنتاجية</h3>
                        <div class="code-block">
                            <button class="copy-btn" onclick="copyCode('envProduction')">نسخ</button>
                            <pre><code id="envProduction"># .env.production
BAS_BASE_URL=https://api.basgate.com
BAS_CLIENT_ID=your_production_client_id
BAS_CLIENT_SECRET=your_production_client_secret
BAS_APP_ID=your_production_app_id
BAS_MERCHANT_KEY=your_production_merchant_key
BAS_VERIFY_SSL=true
BAS_TIMEOUT=30</code></pre>
                        </div>
                    </div>

                    <!-- Security Checklist -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">🛡️ قائمة الأمان</h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Laravel Security</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">تفعيل HTTPS</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">تشفير البيانات الحساسة</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">تسجيل العمليات</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">التحقق من الصلاحيات</span>
                                    </label>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-700 mb-2">Flutter Security</h4>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">تشفير التخزين المحلي</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">التحقق من صحة البيانات</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">معالجة الأخطاء</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="mr-2">
                                        <span class="text-sm">اختبار على أجهزة حقيقية</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Monitoring -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-3">📊 المراقبة والتتبع</h3>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-2">نصائح للمراقبة:</h4>
                            <ul class="list-disc list-inside space-y-1 text-gray-700">
                                <li>تسجيل جميع عمليات الدفع (نجاح/فشل)</li>
                                <li>مراقبة أوقات الاستجابة</li>
                                <li>تتبع معدلات النجاح</li>
                                <li>إعداد تنبيهات للأخطاء</li>
                                <li>مراجعة دورية للسجلات</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center space-x-4">
                    <button onclick="goToPreviousStep()" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors">
                        ← الخطوة السابقة
                    </button>
                    <button onclick="completeStep(5)" class="bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700 transition-colors">
                        🎉 أكمل الدليل
                    </button>
                </div>
            </div>

            <!-- Completion -->
            <div class="step-card rounded-xl p-8 mb-8 hidden text-center" id="completion">
                <div class="mb-6">
                    <div class="text-6xl mb-4">🎉</div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">تهانينا!</h2>
                    <p class="text-gray-600">لقد أكملت ربط بوابة الدفع BAS بنجاح</p>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">ما تم إنجازه:</h3>
                    <ul class="list-disc list-inside space-y-1 text-gray-700 text-right">
                        <li>إعداد Laravel Backend مع BAS SDK</li>
                        <li>إعداد Flutter Frontend مع BAS SDK</li>
                        <li>ربط Frontend مع Backend</li>
                        <li>اختبار عملية الدفع الكاملة</li>
                        <li>إعداد البيئة الإنتاجية</li>
                    </ul>
                </div>

                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-800">📚 موارد إضافية:</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <a href="https://github.com/Osamah-Attiah/bas_pay_flutter" target="_blank" 
                           class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                            <h4 class="font-semibold">Flutter SDK</h4>
                            <p class="text-sm text-gray-600">مستودع GitHub</p>
                        </a>
                        <a href="https://basgate.com" target="_blank" 
                           class="bg-gray-100 p-4 rounded-lg hover:bg-gray-200 transition-colors">
                            <h4 class="font-semibold">BAS Gateway</h4>
                            <p class="text-sm text-gray-600">الموقع الرسمي</p>
                        </a>
                    </div>
                </div>

                <!-- Examples Notice -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mt-6">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-purple-400" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="mr-3">
                            <h3 class="text-sm font-medium text-purple-800">🎯 ملفات الأمثلة الكاملة</h3>
                            <div class="mt-2 text-sm text-purple-700">
                                <p>جميع ملفات الأمثلة متوفرة في مجلد <code>examples/</code>:</p>
                                <div class="grid md:grid-cols-2 gap-2 mt-2">
                                    <ul class="list-disc list-inside space-y-1">
                                        <li><code>flutter_service.dart</code></li>
                                        <li><code>usage_example.dart</code></li>
                                        <li><code>laravel_controller.php</code></li>
                                    </ul>
                                    <ul class="list-disc list-inside space-y-1">
                                        <li><code>migration.php</code></li>
                                        <li><code>payment_model.php</code></li>
                                        <li><code>laravel_routes.php</code></li>
                                    </ul>
                                </div>
                                <p class="mt-2 font-medium">انسخ هذه الملفات واستخدمها مباشرة في مشروعك!</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <button onclick="resetGuide()" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                        🔄 إعادة تشغيل الدليل
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/script.js"></script>
</body>
</html>
